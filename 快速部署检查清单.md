# 快速部署检查清单

## 部署前准备

### 1. 云服务器
- [ ] 已购买云服务器（推荐：腾讯云/阿里云）
- [ ] 已获取服务器 IP 地址
- [ ] 已获取 root 密码或 SSH 密钥

### 2. 域名
- [ ] 已购买域名
- [ ] 域名已备案（国内服务器必需）
- [ ] 域名已解析到服务器 IP

### 3. 微信小程序
- [ ] 已获取 AppID
- [ ] 已获取 AppSecret
- [ ] 已登录微信公众平台

## 服务器环境

### 基础软件
- [ ] Node.js 16+ 已安装
- [ ] MySQL 已安装并运行
- [ ] Nginx 已安装并运行
- [ ] PM2 已安装

### 网络配置
- [ ] 防火墙已配置（开放 80、443、22 端口）
- [ ] 安全组已配置（云服务器控制台）

## 代码部署

### 上传代码
- [ ] 代码已上传到服务器（/opt/longmarch-server）
- [ ] 文件权限正确

### 数据库
- [ ] 数据库已创建（longmarch）
- [ ] 数据库表已初始化
- [ ] 数据库用户已创建（可选）

### 环境变量
- [ ] .env 文件已创建
- [ ] WECHAT_APPID 已配置
- [ ] WECHAT_APPSECRET 已配置
- [ ] 数据库连接信息已配置

### 服务启动
- [ ] 依赖已安装（npm install）
- [ ] PM2 服务已启动
- [ ] 服务开机自启已配置

## Nginx 配置

- [ ] Nginx 配置文件已创建
- [ ] 反向代理已配置
- [ ] 配置已启用并测试通过

## SSL 证书

- [ ] Certbot 已安装
- [ ] SSL 证书已获取
- [ ] HTTPS 已配置并测试

## 小程序配置

### 代码更新
- [ ] config.js 中的 production 地址已更新
- [ ] 小程序已重新编译

### 域名配置
- [ ] 微信公众平台域名已配置
- [ ] request合法域名已添加
- [ ] uploadFile合法域名已添加
- [ ] downloadFile合法域名已添加

## 测试验证

### 服务器测试
- [ ] https://你的域名.com/health 可以访问
- [ ] 返回正确的 JSON 响应

### 小程序测试
- [ ] 小程序可以正常打开
- [ ] 登录功能正常
- [ ] 步数同步功能正常
- [ ] 数据统计功能正常

## 部署后维护

### 监控
- [ ] PM2 监控已设置
- [ ] 日志查看方式已了解

### 备份
- [ ] 数据库备份策略已制定
- [ ] 代码备份方式已确定

### 更新
- [ ] 代码更新流程已了解
- [ ] 服务重启方式已掌握

## 快速命令参考

```bash
# 查看服务状态
pm2 status

# 查看日志
pm2 logs longmarch-server

# 重启服务
pm2 restart longmarch-server

# 停止服务
pm2 stop longmarch-server

# 查看 Nginx 日志
sudo tail -f /var/log/nginx/error.log

# 测试 Nginx 配置
sudo nginx -t

# 重载 Nginx
sudo systemctl reload nginx
```

## 遇到问题？

如果部署过程中遇到问题：
1. 查看服务器日志
2. 检查配置文件
3. 测试网络连接
4. 查看错误信息

告诉我具体问题，我会继续帮你解决！
