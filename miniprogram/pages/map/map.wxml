<!--pages/map/map.wxml-->
<view class="container">
  <!-- 进度概览 -->
  <view class="overview-card card">
    <view class="overview-header">
      <text class="overview-title">长征路进度</text>
      <text class="overview-percent">{{progressPercent}}%</text>
    </view>
    <view class="overview-stats">
      <view class="overview-item">
        <text class="overview-label">已走里程</text>
        <text class="overview-value">{{totalDistance}} 公里</text>
      </view>
      <view class="overview-item">
        <text class="overview-label">总里程</text>
        <text class="overview-value">25000 公里</text>
      </view>
    </view>
    <view class="progress-bar-large">
      <view class="progress-fill-large" style="width: {{progressPercent}}%"></view>
    </view>
  </view>

  <!-- 当前位置 -->
  <view class="location-card card">
    <view class="location-header">
      <text class="location-title">当前位置</text>
    </view>
    <view class="current-location">
      <text class="location-name">{{currentLocation}}</text>
      <text class="location-distance">已走 {{totalDistance}} 公里</text>
    </view>
    <view class="next-location" wx:if="{{nextLocation}}">
      <text class="next-label">下一站：{{nextLocation}}</text>
      <text class="next-distance">还需 {{remainingDistance}} 公里</text>
    </view>
  </view>

  <!-- 路线图 -->
  <view class="route-card card">
    <view class="route-header">
      <text class="route-title">长征路线图</text>
    </view>
    <view class="route-timeline">
      <view class="timeline-item {{item.distance <= totalDistance ? 'completed' : ''}}" 
            wx:for="{{locations}}" 
            wx:key="name"
            wx:for-index="idx">
        <view class="timeline-dot">
          <view class="dot-inner" wx:if="{{item.distance <= totalDistance}}"></view>
        </view>
        <view class="timeline-content">
          <text class="timeline-name">{{item.name}}</text>
          <text class="timeline-distance">{{item.distance}} 公里</text>
        </view>
        <view class="timeline-line" wx:if="{{idx < locations.length - 1}}"></view>
      </view>
    </view>
  </view>

  <!-- 处室进度（可选） -->
  <view class="dept-card card" wx:if="{{departmentDistance}}">
    <view class="dept-header">
      <text class="dept-title">{{userInfo.department}} 处室进度</text>
    </view>
    <view class="dept-stats">
      <text class="dept-distance">已走 {{departmentDistance}} 公里</text>
      <text class="dept-percent">完成度 {{departmentProgress}}%</text>
    </view>
    <view class="progress-bar">
      <view class="progress-fill" style="width: {{departmentProgress}}%"></view>
    </view>
  </view>
</view>
