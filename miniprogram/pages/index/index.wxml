<!--pages/index/index.wxml-->
<view class="container">
  <!-- 用户信息卡片 -->
  <view class="user-card card">
    <view class="user-info">
      <image class="avatar" wx:if="{{userInfo.avatar}}" src="{{userInfo.avatar}}" mode="aspectFill"></image>
      <view class="avatar avatar-placeholder" wx:else>
        <text class="avatar-text">{{userInfo.nickname ? userInfo.nickname.charAt(0) : '用'}}</text>
      </view>
      <view class="user-details">
        <text class="nickname">{{userInfo.nickname || '用户'}}</text>
        <text class="department">{{userInfo.department || ''}}</text>
      </view>
    </view>
    <button class="sync-btn" bindtap="syncSteps">同步步数</button>
  </view>

  <!-- 今日步数 -->
  <view class="steps-card card">
    <view class="card-header">
      <text class="card-title">今日步数</text>
      <text class="card-date">{{todayDate}}</text>
    </view>
    <view class="steps-display">
      <text class="steps-number">{{todaySteps}}</text>
      <text class="steps-unit">步</text>
    </view>
    <view class="distance-info">
      <text>约 {{todayDistance}} 公里</text>
    </view>
  </view>

  <!-- 本周统计 -->
  <view class="week-card card">
    <view class="card-header">
      <text class="card-title">本周累计</text>
    </view>
    <view class="week-stats">
      <view class="stat-item">
        <text class="stat-value">{{weekSteps}}</text>
        <text class="stat-label">步数</text>
      </view>
      <view class="stat-item">
        <text class="stat-value">{{totalDistance}}</text>
        <text class="stat-label">公里</text>
      </view>
    </view>
  </view>

  <!-- 处室排名 -->
  <view class="ranking-card card" bindtap="goToRanking">
    <view class="card-header">
      <text class="card-title">处室排名</text>
      <text class="more">查看全部 ></text>
    </view>
    <view class="ranking-info">
      <view class="rank-badge">
        <text class="rank-number">第{{departmentRank}}名</text>
      </view>
      <view class="ranking-details">
        <text class="dept-name">{{userInfo.department}}</text>
        <text class="dept-steps">累计 {{departmentTotalSteps}} 步</text>
      </view>
    </view>
  </view>

  <!-- 长征路进度 -->
  <view class="progress-card card" bindtap="goToMap">
    <view class="card-header">
      <text class="card-title">长征路进度</text>
      <text class="more">查看地图 ></text>
    </view>
    <view class="progress-info">
      <text class="progress-text">已完成 {{progressPercent}}%</text>
      <view class="progress-bar">
        <view class="progress-fill" style="width: {{progressPercent}}%"></view>
      </view>
      <text class="progress-distance">已走 {{totalDistance}} 公里 / 25000 公里</text>
    </view>
  </view>
</view>
